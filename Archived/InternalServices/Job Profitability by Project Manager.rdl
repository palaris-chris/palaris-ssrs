<?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns:cl="http://schemas.microsoft.com/sqlserver/reporting/2010/01/componentdefinition" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="PalarisNAV">
      <DataSourceReference>/PalarisNAV</DataSourceReference>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>fde7dbcf-5393-43f0-a87f-2f4f69203a47</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="AllBUTime">
      <Query>
        <DataSourceName>PalarisNAV</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@LastFriday">
            <Value>=Parameters!LastFriday.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@StartDate">
            <Value>=Parameters!StartDate.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;
;WITH BUGroup AS
(
SELECT [Business Unit Group], [Business Unit]
    FROM [Business Unit Group]
),

JLE AS
(
SELECT
  jle.[Job No_]
  ,jle.[Job Task No_]
  ,jle.[Entry No_] as [Line_No_]
  ,jle.[Posting Date] as [Date]
  ,jle.Type
  ,jle.No_
  ,jle.Quantity AS [Qty]
  ,jle.[Quantity (Base)]
  ,jle.[Unit of Measure Code] AS [Unit]
  ,jle.[Work Type Code] AS [Work Type]
  ,jle.[Global Dimension 2 Code] as [BU]
  ,bug.[Business Unit Group] as [BUGroup]
  ,jle.[Entry Type] as [Line Type]
  ,res.[Name] as [Resource]
  ,res.[Search Name]
  ,jt.[Description] as [Task]
,CASE 
    WHEN LEFT(jle.[Job No_], 2) NOT LIKE 'T-' AND jle.[Work Type Code] IN ('BILLHR', 'BILLDAY') OR jle.[Work Type Code] = 'C_BILLDAY' THEN 'BILLHR'
    WHEN LEFT(jle.[Job No_], 2) NOT LIKE 'T-' AND jle.[Work Type Code] IN ('NBTHR', 'NBTDAY') OR jle.[Work Type Code] IN ('C_NBTDAY', 'C_PROJPREP') THEN 'NBTHR'
    WHEN jle.[Work Type Code] IN ('APPTRAIN', 'APPTD', 'APPDISBER') OR jle.[Job No_] LIKE 'T-INTERNAL%' AND jle.[Job Task No_] = 'I0610' THEN 'DEDDISC' 
    WHEN jle.[Job No_] LIKE 'T-INTERNAL%' AND jle.[Job Task No_] IN ('I0201', 'I0202', 'I0605') THEN 'MEETING'
    WHEN jle.[Job No_] LIKE 'T-INTERNAL%' AND jle.[Job Task No_] = 'I0208' OR jle.[Job No_] = 'T-SUPPORT' THEN 'EXEC'
    WHEN jle.[Job No_] LIKE 'T-INTERNAL%' AND jle.[Job Task No_] = 'I0204' OR jle.[Work Type Code] = 'C_BUSDEV' THEN 'BUSDEV'
    WHEN jle.[Job No_] LIKE 'T-INTERNAL%' AND jle.[Job Task No_] = 'I0600' THEN 'INVMGMT'
    WHEN jle.[Job No_] LIKE 'T-INTERNAL%' AND jle.[Job Task No_] IN ('I0500', 'I0501', 'I0502', 'I0503', 'I0504', 'I0505') OR jle.[Work Type Code]='C_PROPOSAL' THEN 'PROPOSAL'
    WHEN jle.[Work Type Code] IN ('AL-DAY', 'C_ALDAY') THEN 'LEAVEAPP'
    WHEN jle.[Work Type Code] IN ('PUBLIC-DAY', 'SICK-DAY', 'STUDY-DAY', 'COMP-DAY', 'LSL-DAY', 'FLEX-DAY', 'SPECIAL', 'JSDAY', 'JS-SP-DAY', 'MATERNITY', 'GOVT-PPL', 'C_PHOLDAY') THEN 'LEAVEOTH'
    WHEN jle.[Work Type Code] IN ('LWOP-DAY', 'C_LWOP') THEN 'LWOP' 
    WHEN jle.[Job No_] LIKE 'T-INTERNAL%' AND jle.[Job Task No_] = 'I0620' THEN 'UNUSED'
    ELSE NULL
  END AS [NBTReport]
FROM
  [Palaris$Job Ledger Entry] jle WITH (NOLOCK) 
  LEFT JOIN [Palaris$Resource] res WITH (NOLOCK) ON jle.[No_] = res.[No_]
  LEFT JOIN [Palaris$Job Task] jt  WITH (NOLOCK) ON jle.[Job Task No_] = jt.[Job Task No_] AND jle.[Job No_] = jt.[Job No_]
  LEFT JOIN BUGroup bug  WITH (NOLOCK) ON jle.[Global Dimension 2 Code]= bug.[Business Unit]

WHERE
  jle.[Entry Type] = 0
  AND jle.[Type] = 0
  AND jle.[Posting Date] BETWEEN @StartDate AND @LastFriday
  AND jle.No_ NOT LIKE 'R9%'
  AND jle.[Job No_] NOT LIKE 'T-CAPACITY%'
  AND jle.[Work Type Code] NOT LIKE 'OSA%'
  AND jle.[Work Type Code] NOT LIKE 'KM%' 
  AND jle.[Work Type Code] NOT LIKE 'PAY%'
  AND bug.[Business Unit Group] NOT LIKE 'INS%'
  ),
  
  JPL AS 
  (
  SELECT
  jpl.[Job No_]
  ,jpl.[Job Task No_]
  ,jpl.[Line No_]
  ,jpl.[Planning Date] as [Date]
  ,jpl.Type
  ,jpl.No_
  ,jpl.Quantity AS [Qty]
  ,jpl.[Quantity (Base)]
  ,jpl.[Unit of Measure Code] AS [Unit]
  ,jpl.[Work Type Code] AS [Work Type]
  ,res.[Global Dimension 2 Code] as [BU]
  ,bug.[Business Unit Group] as [BUGroup]
  ,jpl.[Schedule Line] AS [Line Type]


  ,res.[Name] as [Resource]
  ,res.[Search Name]
  ,jt.[Description] as [Task]

,CASE 
    WHEN LEFT(jpl.[Job No_], 2) NOT LIKE 'T-' AND jpl.[Work Type Code] IN ('BILLHR', 'BILLDAY') OR jpl.[Work Type Code] = 'C_BILLDAY' THEN 'BILLHR'
    WHEN LEFT(jpl.[Job No_], 2) NOT LIKE 'T-' AND jpl.[Work Type Code] IN ('NBTHR', 'NBTDAY') OR jpl.[Work Type Code] IN ('C_NBTDAY', 'C_PROJPREP') THEN 'NBTHR'
    WHEN jpl.[Work Type Code] IN ('APPTRAIN', 'APPTD', 'APPDISBER') OR jpl.[Job No_] LIKE 'T-INTERNAL%' AND jpl.[Job Task No_] = 'I0610' THEN 'DEDDISC' 
    WHEN jpl.[Job No_] LIKE 'T-INTERNAL%' AND jpl.[Job Task No_] IN ('I0201', 'I0202', 'I0605') THEN 'MEETING'
    WHEN jpl.[Job No_] LIKE 'T-INTERNAL%' AND jpl.[Job Task No_] = 'I0208' OR jpl.[Job No_] = 'T-SUPPORT' THEN 'EXEC'
    WHEN jpl.[Job No_] LIKE 'T-INTERNAL%' AND jpl.[Job Task No_] = 'I0204' OR jpl.[Work Type Code] = 'C_BUSDEV' THEN 'BUSDEV'
    WHEN jpl.[Job No_] LIKE 'T-INTERNAL%' AND jpl.[Job Task No_] = 'I0600' THEN 'INVMGMT'
    WHEN jpl.[Job No_] LIKE 'T-INTERNAL%' AND jpl.[Job Task No_] IN ('I0500', 'I0501', 'I0502', 'I0503', 'I0504', 'I0505') OR jpl.[Work Type Code]='C_PROPOSAL' THEN 'PROPOSAL'
    WHEN jpl.[Work Type Code] IN ('AL-DAY', 'C_ALDAY') THEN 'LEAVEAPP'
    WHEN jpl.[Work Type Code] IN ('PUBLIC-DAY', 'SICK-DAY', 'STUDY-DAY', 'COMP-DAY', 'LSL-DAY', 'FLEX-DAY', 'SPECIAL', 'JSDAY', 'JS-SP-DAY', 'MATERNITY', 'GOVT-PPL', 'C_PHOLDAY') THEN 'LEAVEOTH'
    WHEN jpl.[Work Type Code] IN ('LWOP-DAY', 'C_LWOP') THEN 'LWOP' 
    WHEN jpl.[Job No_] LIKE 'T-INTERNAL%' AND jpl.[Job Task No_] = 'I0620' THEN 'UNUSED'
    ELSE NULL
  END AS [NBTReport]

FROM
  [Palaris$Job Planning Line] jpl WITH (NOLOCK) 
  LEFT JOIN [Palaris$Resource] res  WITH (NOLOCK) ON jpl.[Job Task No_] = res.[No_]
  LEFT JOIN [Palaris$Job Task] jt  WITH (NOLOCK) ON jpl.[Job Task No_] = jt.[Job Task No_] AND jpl.[Job No_] = jt.[Job No_]
  LEFT JOIN BUGroup bug  WITH (NOLOCK) ON res.[Global Dimension 2 Code] = bug.[Business Unit]
WHERE
  jpl.[Job No_] LIKE 'T-CAPACITY%'
  AND jpl.[Schedule Line] = 1
  AND jpl.[Planning Date] BETWEEN @StartDate AND @LastFriday
  AND bug.[Business Unit Group] NOT LIKE 'INS%'
  )
  
  SELECT JPL.*FROM JPL  
WHERE [NBTReport] IS NOT NULL 
  UNION ALL
  SELECT JLE.*FROM JLE
WHERE [NBTReport] IS NOT NULL</CommandText>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
      <Fields>
        <Field Name="Job_No_">
          <DataField>Job No_</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Job_Task_No_">
          <DataField>Job Task No_</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Line_No_">
          <DataField>Line No_</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="Date">
          <DataField>Date</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="Type">
          <DataField>Type</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="No_">
          <DataField>No_</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Qty">
          <DataField>Qty</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="Quantity__Base_">
          <DataField>Quantity (Base)</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="Unit">
          <DataField>Unit</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Work_Type">
          <DataField>Work Type</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="BU">
          <DataField>BU</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Line_Type">
          <DataField>Line Type</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="BUGroup">
          <DataField>BUGroup</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Resource">
          <DataField>Resource</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Search_Name">
          <DataField>Search Name</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="NBTReport">
          <DataField>NBTReport</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Task">
          <DataField>Task</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Entry">
          <Value>=IIf(Fields!Line_Type.Value=0, "Usage", "Proposed")</Value>
        </Field>
        <Field Name="Job_Task">
          <Value>=Fields!Job_Task_No_.Value &amp; " | " &amp; Fields!Task.Value</Value>
        </Field>
        <Field Name="ResExp">
          <Value>=IIf(Fields!Type.Value=0, "Resource", "Expense")</Value>
        </Field>
        <Field Name="FinalHrs">
          <Value>=IIf(Fields!Unit.Value &lt;&gt; "DAY", Fields!Qty.Value, IIf(Fields!Line_Type.Value = "1", Fields!Qty.Value * 8, Fields!Qty.Value * 9))</Value>
        </Field>
        <Field Name="WorkTypeInHrs">
          <Value>=IIf
(
Fields!Work_Type.Value="NBTDAY", "NBTHR", 
IIf(Fields!Work_Type.Value="BILLDAY", "BILLHR", 
IIf(Fields!Work_Type.Value="C_BILLDAY", "BILLHR", 
IIf(Fields!Work_Type.Value="C_ALDAY", "AL-DAY", 
IIf(Fields!Work_Type.Value="C_BUSDEV", "BUSDEV", 
IIf(Fields!Work_Type.Value="C_LWOP", "LWOP", 
IIf(Fields!Work_Type.Value="LWOP-DAY", "LWOP", 
IIf(Fields!Work_Type.Value="C_NBTDAY", "NBTHR", 
IIf(Fields!Work_Type.Value="C_PROJPREP", "PROJPREP", 
IIf(Fields!Work_Type.Value="C_PROPOSAL", "PROPOSAL", 
IIf(Fields!Work_Type.Value="APPDISBER", "DEDDISC", 
IIf(Fields!Job_No_.Value="T-INTERNAL" and Fields!Job_Task_No_.Value="I0201", "MEETING", 
IIf(Fields!Job_No_.Value="T-INTERNAL" and Fields!Job_Task_No_.Value="I0202", "MEETING", 
IIf(Fields!Job_No_.Value="T-INTERNAL" and Fields!Job_Task_No_.Value="I0208", "EXEC", 
IIf(Fields!Job_No_.Value="T-INTERNAL" and Fields!Job_Task_No_.Value="I0250", "DEDDISC", 
IIf(Fields!Job_No_.Value="T-INTERNAL" and Fields!Job_Task_No_.Value="I0260", "DEDDISC", 
IIf(Fields!Job_No_.Value="T-INTERNAL" and Fields!Job_Task_No_.Value="I0610", "DEDDISC", 
IIf(Fields!Job_No_.Value="T-INTERNAL" and Fields!Job_Task_No_.Value="I0600", "INVMGMT", 
IIf(Fields!Job_No_.Value="T-INTERNAL" and Fields!Job_Task_No_.Value="I0605", "MEETING", 
IIf(Fields!Job_No_.Value="T-INTERNAL" and Fields!Job_Task_No_.Value="I0204", "BUSDEV", 
IIf(Fields!Job_No_.Value="T-INTERNAL" and Fields!Job_Task_No_.Value="I0500", "PROPOSAL", 
IIf(Fields!Job_No_.Value="T-INTERNAL" and Fields!Job_Task_No_.Value="I0501", "PROPOSAL", 
IIf(Fields!Job_No_.Value="T-INTERNAL" and Fields!Job_Task_No_.Value="I0502", "PROPOSAL", 
IIf(Fields!Job_No_.Value="T-INTERNAL" and Fields!Job_Task_No_.Value="I0503", "PROPOSAL", 
IIf(Fields!Job_No_.Value="T-INTERNAL" and Fields!Job_Task_No_.Value="I0504", "PROPOSAL", 
IIf(Fields!Job_No_.Value="T-INTERNAL" and Fields!Job_Task_No_.Value="I0505", "PROPOSAL", 
IIf(Fields!Job_No_.Value="T-INTERNAL" and Fields!Job_Task_No_.Value="I0620", "UNUSED", 
"OTHER-LEAVE"))
)))))))))))))))))))))))))</Value>
        </Field>
        <Field Name="WeekEnding">
          <Value>=DateAdd("d",6-iif(Weekday(Fields!Date.Value)=7,0,Weekday(Fields!Date.Value)),Fields!Date.Value)</Value>
        </Field>
        <Field Name="Ordering">
          <Value>=Switch
(
Fields!NBTReport.Value = "BILLHR", "1. Projects Billable",
Fields!NBTReport.Value = "NBTHR", "2. Projects Non-Billable",
Fields!NBTReport.Value = "LEAVEAPP", "3. Deductibles",
Fields!NBTReport.Value = "DEDDISC", "3. Deductibles",
Fields!NBTReport.Value = "LEAVEOTH", "3. Deductibles", 
Fields!NBTReport.Value = "BUSDEV", "4. BD and Proposals", 
Fields!NBTReport.Value = "PROPOSAL", "4. BD and Proposals", 
Fields!NBTReport.Value = "MEETING", "5. Non Project - Other", 
Fields!NBTReport.Value = "EXEC", "5. Non Project - Other", 
Fields!NBTReport.Value = "INVMGMT", "5. Non Project - Other", 
Fields!NBTReport.Value = "LWOP", "6. Unpaid Leave", 
Fields!NBTReport.Value = "UNUSED", "7. Unused", 
True, "")</Value>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="Customers">
      <Query>
        <DataSourceName>PalarisNAV</DataSourceName>
        <CommandText>SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;
;WITH BUGroup AS
(
SELECT [Business Unit Group], [Business Unit]
    FROM [Business Unit Group] WITH (NOLOCK)
)

SELECT
  job.No_
  ,job.Description
  ,job.[Global Dimension 2 Code]
  ,bug.[Business Unit Group]
  ,dd.[Dimension Value Code] AS Sector
  ,dd.[Dimension Code]
  ,job.[Job Type]
  ,job.[Person Responsible]
  ,job.[Bill-to Customer No_]
  ,res.[Windows Name]
  ,cust.[Name]
  ,job.[Customer PO Value]
,-1*(SELECT
SUM(jle.[Line Amount (LCY)])
FROM
  [Palaris$Job Ledger Entry] jle
WHERE
  jle.[Job No_] = Job.No_
  AND jle.[Entry Type] = 1) AS Invoiced
  
FROM
[Palaris$Job] job WITH (NOLOCK)
LEFT JOIN [Palaris$Resource] res WITH (NOLOCK) ON job.[Person Responsible] = res.[No_]
LEFT JOIN [Palaris$Customer] cust WITH (NOLOCK) ON job.[Bill-to Customer No_] = cust.[No_]
LEFT JOIN [Palaris$Default Dimension] dd WITH (NOLOCK) ON job.[No_] = dd.[No_]
LEFT JOIN BUGroup bug ON job.[Global Dimension 2 Code] = bug.[Business Unit]

WHERE
job.[Starting Date] &gt; DATEADD(month, -12, GETDATE()) AND
job.[No_] NOT LIKE 'T-%' AND job.[No_] NOT LIKE 'TEST%' AND
bug.[Business Unit Group] NOT LIKE 'INS%' AND
dd.[Dimension Code] = 'SECTOR'
ORDER BY Invoiced desc</CommandText>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
      <Fields>
        <Field Name="No_">
          <DataField>No_</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Description">
          <DataField>Description</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Global_Dimension_2_Code">
          <DataField>Global Dimension 2 Code</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Business_Unit_Group">
          <DataField>Business Unit Group</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Job_Type">
          <DataField>Job Type</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="Sector">
          <DataField>Sector</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Person_Responsible">
          <DataField>Person Responsible</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Dimension_Code">
          <DataField>Dimension Code</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Bill_to_Customer_No_">
          <DataField>Bill-to Customer No_</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Windows_Name">
          <DataField>Windows Name</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Name">
          <DataField>Name</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Customer_PO_Value">
          <DataField>Customer PO Value</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="Invoiced">
          <DataField>Invoiced</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
      </Fields>
      <Filters>
        <Filter>
          <FilterExpression>=FormatNumber(Fields!Invoiced.Value)</FilterExpression>
          <Operator>NotEqual</Operator>
          <FilterValues>
            <FilterValue>0</FilterValue>
          </FilterValues>
        </Filter>
      </Filters>
    </DataSet>
    <DataSet Name="JPL_JLE">
      <Query>
        <DataSourceName>PalarisNAV</DataSourceName>
        <CommandText>SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;
WITH BUGroup AS
(
SELECT [Business Unit Group], [Business Unit]
    FROM [Business Unit Group]
),

JLE AS
(
SELECT
  jle.[Job No_]
  ,jle.[Job Task No_]
  ,jle.No_
  ,jle.Quantity AS [Qty]
  ,jle.[Work Type Code] AS [Work Type]
  ,job.[Global Dimension 2 Code] as [BU]
  ,bug.[Business Unit Group] as [BUGroup]
  ,jle.[Entry Type] as [Line Type]
  ,res.[Name] as [Resource]
  ,res.[Search Name]
  ,jt.[Description] as [Task]
,CASE
WHEN jle.[Entry Type] = 1 THEN 'PROPTIME'
ELSE 'USETIME'
END AS [TIMEREPORT]
FROM
  [Palaris$Job Ledger Entry] jle
  LEFT JOIN [Palaris$Resource] res WITH (NOLOCK) ON jle.[No_] = res.[No_]
  LEFT JOIN [Palaris$Job Task] jt WITH (NOLOCK) ON jle.[Job Task No_] = jt.[Job Task No_] AND jle.[Job No_] = jt.[Job No_]
  LEFT JOIN [Palaris$Job] job WITH (NOLOCK) ON jle.[Job No_] = job.[No_]
  LEFT JOIN BUGroup bug WITH (NOLOCK) ON job.[Global Dimension 2 Code] = bug.[Business Unit]

WHERE
  jle.[Entry Type] = 0
  AND jle.[Work Type Code] NOT LIKE 'OSA%' 
  AND jle.[Work Type Code] NOT LIKE 'KM%'
  AND jle.[No_] NOT LIKE 'R9998'
  AND bug.[Business Unit Group] NOT LIKE 'INS%'
  AND jle.[Job No_] IN 
  (		SELECT
		  job.No_  
		FROM
		 [Palaris$Job] job WITH (NOLOCK)
		WHERE
		  job.[Project Status] = N'ACTIVE'
		  )

  ),
  
  JPL AS 
  (
  SELECT
  jpl.[Job No_]
  ,jpl.[Job Task No_]
  ,jpl.No_
  ,jpl.Quantity AS [Qty]
  ,jpl.[Work Type Code] AS [Work Type]
  ,job.[Global Dimension 2 Code] as [BU]
  ,bug.[Business Unit Group] as [BUGroup]
  ,jpl.[Schedule Line] AS [Line Type]
  ,res.[Name] as [Resource]
  ,res.[Search Name]
  ,jt.[Description] as [Task]
,CASE
WHEN jpl.[Schedule Line] = 1 THEN 'PROPTIME'
ELSE 'USETIME'
END AS [TIMEREPORT]
FROM
  [Palaris$Job Planning Line] jpl
  LEFT JOIN [Palaris$Resource] res WITH (NOLOCK) ON jpl.[No_] = res.[No_]
  LEFT JOIN [Palaris$Job Task] jt WITH (NOLOCK) ON jpl.[Job Task No_] = jt.[Job Task No_] AND jpl.[Job No_] = jt.[Job No_]
  LEFT JOIN [Palaris$Job] job WITH (NOLOCK) ON jpl.[Job No_] = job.[No_]
  LEFT JOIN BUGroup bug WITH (NOLOCK) ON job.[Global Dimension 2 Code] = bug.[Business Unit]

WHERE
  jpl.[Schedule Line] = 1
  AND jpl.[Work Type Code] NOT LIKE 'OSA%' 
  AND jpl.[Work Type Code] NOT LIKE 'KM%'
  AND jpl.[No_] NOT LIKE 'R9998'
  AND bug.[Business Unit Group] NOT LIKE 'INS%'
  AND   jpl.[Job No_] IN 
  (		SELECT
		  job.No_  
		FROM
		 [Palaris$Job] job WITH (NOLOCK)
		WHERE
		  job.[Project Status] = N'ACTIVE'
		  )
  ),

Merged AS (
  SELECT JPL.* FROM JPL
  UNION ALL
  SELECT JLE.* FROM JLE
),

Result AS
( 
SELECT
Merged.[Job No_], Merged.[Job Task No_], Merged.[Task], Merged.Qty, Merged.[TIMEREPORT] 
FROM Merged
)

SELECT * FROM Result

PIVOT 
(
SUM(Result.[Qty]) for [TIMEREPORT] IN ([PROPTIME], [USETIME]))
AS TotalAmount
ORDER BY [Job No_]</CommandText>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
      <Fields>
        <Field Name="Job_No_">
          <DataField>Job No_</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Job_Task_No_">
          <DataField>Job Task No_</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Task">
          <DataField>Task</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Proposed">
          <DataField>PROPTIME</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="Used">
          <DataField>USETIME</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="JobTask">
          <Value>=Fields!Job_Task_No_.Value &amp; " | " &amp; Fields!Task.Value</Value>
        </Field>
        <Field Name="Remaining">
          <Value>=Fields!Proposed.Value - Fields!Used.Value</Value>
        </Field>
        <Field Name="Percent">
          <Value>=IIf(Fields!Proposed.Value=0, 1.01, Fields!Used.Value / IIf(Fields!Proposed.Value = 0, 1.01, Fields!Proposed.Value))</Value>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="Profitability">
      <Query>
        <DataSourceName>PalarisNAV</DataSourceName>
        <CommandText>SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;
;WITH BUGroup AS
(
SELECT [Business Unit Group], [Business Unit]
    FROM [Business Unit Group] WITH (NOLOCK)
)

SELECT
  job.No_
  ,job.Description
  ,job.[Global Dimension 2 Code]
  ,bug.[Business Unit Group]
  ,res.[Name]
  ,job.[Job Type]
  ,job.[Person Responsible]
  ,job.[Bill-to Customer No_]
  ,job.[Customer PO Value]
,job.[Planned Margin _]
  ,(SELECT
SUM(jpl.[Total Cost (LCY)])
FROM
  [Palaris$Job Planning Line] jpl
WHERE
  jpl.[Job No_] = Job.No_
  AND jpl.[Schedule Line] = 1) AS PlannedCost
  ,(SELECT
SUM(jpl.[Line Amount (LCY)])
FROM
  [Palaris$Job Planning Line] jpl
WHERE
  jpl.[Job No_] = Job.No_
  AND jpl.[Schedule Line] = 1) AS PlannedPrice
  ,(SELECT
SUM(jle.[Total Cost (LCY)])
FROM
  [Palaris$Job Ledger Entry] jle
WHERE
  jle.[Job No_] = Job.No_
  AND jle.[Entry Type] = 0) AS TotalCost
,-1*(SELECT
SUM(jle.[Line Amount (LCY)])
FROM
  [Palaris$Job Ledger Entry] jle
WHERE
  jle.[Job No_] = Job.No_
  AND jle.[Entry Type] = 1) AS Invoiced

  
FROM
[Palaris$Job] job WITH (NOLOCK)
LEFT JOIN [Palaris$Resource] res WITH (NOLOCK) ON job.[Person Responsible] = res.[No_]
LEFT JOIN BUGroup bug ON job.[Global Dimension 2 Code] = bug.[Business Unit]

WHERE
job.[Ending Date] &gt; DATEADD(month, -6, GETDATE()) AND
job.[No_] NOT LIKE 'T-%' AND job.[No_] NOT LIKE 'TEST%' AND
job.[Calculate Profit] = 1 AND
job.[Status] = 3 AND
bug.[Business Unit Group] NOT LIKE 'INS%' 

ORDER BY Invoiced desc</CommandText>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
      <Fields>
        <Field Name="No_">
          <DataField>No_</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Description">
          <DataField>Description</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Global_Dimension_2_Code">
          <DataField>Global Dimension 2 Code</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Business_Unit_Group">
          <DataField>Business Unit Group</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Name">
          <DataField>Name</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Job_Type">
          <DataField>Job Type</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="Person_Responsible">
          <DataField>Person Responsible</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Bill_to_Customer_No_">
          <DataField>Bill-to Customer No_</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Customer_PO_Value">
          <DataField>Customer PO Value</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="Planned_Margin__">
          <DataField>Planned Margin _</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="PlannedCost">
          <DataField>PlannedCost</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="TotalCost">
          <DataField>TotalCost</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="PlannedPrice">
          <DataField>PlannedPrice</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="Invoiced">
          <DataField>Invoiced</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="ActualMargin">
          <Value>=((Fields!Invoiced.Value - Fields!TotalCost.Value)/Fields!Invoiced.Value)*100</Value>
        </Field>
        <Field Name="ActualMargin_dollar">
          <Value>=Fields!Invoiced.Value - Fields!TotalCost.Value</Value>
        </Field>
        <Field Name="PlannedMargin_dollar">
          <Value>=Fields!PlannedPrice.Value - Fields!PlannedCost.Value</Value>
        </Field>
        <Field Name="PlannedMargin_percent">
          <Value>=(Fields!PlannedMargin_dollar.Value / Fields!PlannedPrice.Value)*100</Value>
        </Field>
      </Fields>
    </DataSet>
  </DataSets>
  <ReportSections>
    <ReportSection>
      <Body>
        <ReportItems>
          <Textbox Name="ReportTitle">
            <CanGrow>true</CanGrow>
            <KeepTogether>true</KeepTogether>
            <Paragraphs>
              <Paragraph>
                <TextRuns>
                  <TextRun>
                    <Value>Job Profitability by Project Manager - past 6 months</Value>
                    <Style>
                      <FontSize>20pt</FontSize>
                      <FontWeight>Bold</FontWeight>
                    </Style>
                  </TextRun>
                </TextRuns>
                <Style />
              </Paragraph>
            </Paragraphs>
            <rd:WatermarkTextbox>Title</rd:WatermarkTextbox>
            <rd:DefaultName>ReportTitle</rd:DefaultName>
            <Top>0mm</Top>
            <Height>10.16mm</Height>
            <Width>334.63006mm</Width>
            <Style>
              <Border>
                <Style>None</Style>
              </Border>
              <BackgroundColor>LightSteelBlue</BackgroundColor>
              <PaddingLeft>2pt</PaddingLeft>
              <PaddingRight>2pt</PaddingRight>
              <PaddingTop>2pt</PaddingTop>
              <PaddingBottom>2pt</PaddingBottom>
            </Style>
          </Textbox>
          <Tablix Name="Tablix4">
            <TablixBody>
              <TablixColumns>
                <TablixColumn>
                  <Width>2.55354cm</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>2.5cm</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>2.65928cm</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>2.5cm</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>2.5cm</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>2.5cm</Width>
                </TablixColumn>
              </TablixColumns>
              <TablixRows>
                <TablixRow>
                  <Height>0.6cm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox35">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>C&amp;E Schedule Value</Value>
                                  <Style>
                                    <FontWeight>Bold</FontWeight>
                                    <Format>n2</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox35</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>LightSteelBlue</BackgroundColor>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox43">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>Planned Margin (%)</Value>
                                  <Style>
                                    <FontWeight>Bold</FontWeight>
                                    <Format>n2</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox43</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>LightSteelBlue</BackgroundColor>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox37">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>Actual Cost</Value>
                                  <Style>
                                    <FontWeight>Bold</FontWeight>
                                    <Format>n2</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox37</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>LightSteelBlue</BackgroundColor>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox39">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>Invoiced</Value>
                                  <Style>
                                    <FontWeight>Bold</FontWeight>
                                    <Format>n2</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox39</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>LightSteelBlue</BackgroundColor>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox53">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>Actual Margin %</Value>
                                  <Style>
                                    <FontWeight>Bold</FontWeight>
                                    <Format>n2</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox53</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>LightSteelBlue</BackgroundColor>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox55">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>Actual Margin  ($)</Value>
                                  <Style>
                                    <FontWeight>Bold</FontWeight>
                                    <Format>'$'#,0.00</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox55</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>LightSteelBlue</BackgroundColor>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                            <rd:FormatSymbolCulture>en-AU</rd:FormatSymbolCulture>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.6cm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="PlannedPrice">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!PlannedPrice.Value</Value>
                                  <Style>
                                    <Format>'$'#,0.00</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>PlannedPrice</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <Style>Solid</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                            <rd:FormatSymbolCulture>en-AU</rd:FormatSymbolCulture>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Planned_Margin__">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!Planned_Margin__.Value</Value>
                                  <Style>
                                    <Format>n2</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Planned_Margin__</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <Style>Solid</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="TotalCost">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!TotalCost.Value</Value>
                                  <Style>
                                    <Format>'$'#,0.00</Format>
                                    <rd:FormatSymbolCulture>en-AU</rd:FormatSymbolCulture>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>TotalCost</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <Style>Solid</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Invoiced1">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!Invoiced.Value</Value>
                                  <Style>
                                    <Format>'$'#,0.00</Format>
                                    <rd:FormatSymbolCulture>en-AU</rd:FormatSymbolCulture>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Invoiced1</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <Style>Solid</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="ActualMargin">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!ActualMargin.Value</Value>
                                  <Style>
                                    <Format>n2</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>ActualMargin</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <Style>Solid</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="ActualMargin_dollar">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!ActualMargin_dollar.Value</Value>
                                  <Style>
                                    <Format>'$'#,0.00</Format>
                                    <rd:FormatSymbolCulture>en-AU</rd:FormatSymbolCulture>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>ActualMargin_dollar</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <Style>Solid</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
              </TablixRows>
            </TablixBody>
            <TablixColumnHierarchy>
              <TablixMembers>
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
              </TablixMembers>
            </TablixColumnHierarchy>
            <TablixRowHierarchy>
              <TablixMembers>
                <TablixMember>
                  <TablixHeader>
                    <Size>2.5cm</Size>
                    <CellContents>
                      <Textbox Name="Textbox3">
                        <CanGrow>true</CanGrow>
                        <KeepTogether>true</KeepTogether>
                        <Paragraphs>
                          <Paragraph>
                            <TextRuns>
                              <TextRun>
                                <Value>Project Manager</Value>
                                <Style>
                                  <FontWeight>Bold</FontWeight>
                                </Style>
                              </TextRun>
                            </TextRuns>
                            <Style />
                          </Paragraph>
                        </Paragraphs>
                        <rd:DefaultName>Textbox3</rd:DefaultName>
                        <Style>
                          <Border>
                            <Color>LightGrey</Color>
                            <Style>Solid</Style>
                          </Border>
                          <BackgroundColor>LightSteelBlue</BackgroundColor>
                          <PaddingLeft>2pt</PaddingLeft>
                          <PaddingRight>2pt</PaddingRight>
                          <PaddingTop>2pt</PaddingTop>
                          <PaddingBottom>2pt</PaddingBottom>
                        </Style>
                      </Textbox>
                    </CellContents>
                  </TablixHeader>
                  <TablixMembers>
                    <TablixMember>
                      <TablixHeader>
                        <Size>2.5cm</Size>
                        <CellContents>
                          <Textbox Name="Textbox57">
                            <CanGrow>true</CanGrow>
                            <KeepTogether>true</KeepTogether>
                            <Paragraphs>
                              <Paragraph>
                                <TextRuns>
                                  <TextRun>
                                    <Value>No </Value>
                                    <Style>
                                      <FontWeight>Bold</FontWeight>
                                    </Style>
                                  </TextRun>
                                </TextRuns>
                                <Style />
                              </Paragraph>
                            </Paragraphs>
                            <rd:DefaultName>Textbox57</rd:DefaultName>
                            <Style>
                              <Border>
                                <Color>LightGrey</Color>
                                <Style>Solid</Style>
                              </Border>
                              <BackgroundColor>LightSteelBlue</BackgroundColor>
                              <PaddingLeft>2pt</PaddingLeft>
                              <PaddingRight>2pt</PaddingRight>
                              <PaddingTop>2pt</PaddingTop>
                              <PaddingBottom>2pt</PaddingBottom>
                            </Style>
                          </Textbox>
                        </CellContents>
                      </TablixHeader>
                      <TablixMembers>
                        <TablixMember />
                      </TablixMembers>
                    </TablixMember>
                  </TablixMembers>
                </TablixMember>
                <TablixMember>
                  <Group Name="Name1">
                    <GroupExpressions>
                      <GroupExpression>=Fields!Name.Value</GroupExpression>
                    </GroupExpressions>
                  </Group>
                  <SortExpressions>
                    <SortExpression>
                      <Value>=Fields!Name.Value</Value>
                    </SortExpression>
                  </SortExpressions>
                  <TablixHeader>
                    <Size>2.5cm</Size>
                    <CellContents>
                      <Textbox Name="Name11">
                        <CanGrow>true</CanGrow>
                        <CanShrink>true</CanShrink>
                        <KeepTogether>true</KeepTogether>
                        <Paragraphs>
                          <Paragraph>
                            <TextRuns>
                              <TextRun>
                                <Value>=Fields!Name.Value</Value>
                                <Style>
                                  <FontWeight>Bold</FontWeight>
                                </Style>
                              </TextRun>
                            </TextRuns>
                            <Style />
                          </Paragraph>
                        </Paragraphs>
                        <rd:DefaultName>Name11</rd:DefaultName>
                        <Style>
                          <Border>
                            <Color>LightGrey</Color>
                            <Style>Solid</Style>
                          </Border>
                          <BackgroundColor>Silver</BackgroundColor>
                          <PaddingLeft>2pt</PaddingLeft>
                          <PaddingRight>2pt</PaddingRight>
                          <PaddingTop>2pt</PaddingTop>
                          <PaddingBottom>2pt</PaddingBottom>
                        </Style>
                      </Textbox>
                    </CellContents>
                  </TablixHeader>
                  <TablixMembers>
                    <TablixMember>
                      <Group Name="No_">
                        <GroupExpressions>
                          <GroupExpression>=Fields!No_.Value</GroupExpression>
                        </GroupExpressions>
                      </Group>
                      <SortExpressions>
                        <SortExpression>
                          <Value>=Fields!No_.Value</Value>
                        </SortExpression>
                      </SortExpressions>
                      <TablixHeader>
                        <Size>2.5cm</Size>
                        <CellContents>
                          <Textbox Name="No_">
                            <CanGrow>true</CanGrow>
                            <KeepTogether>true</KeepTogether>
                            <Paragraphs>
                              <Paragraph>
                                <TextRuns>
                                  <TextRun>
                                    <Value>=Fields!No_.Value</Value>
                                    <Style>
                                      <FontWeight>Bold</FontWeight>
                                    </Style>
                                  </TextRun>
                                </TextRuns>
                                <Style />
                              </Paragraph>
                            </Paragraphs>
                            <rd:DefaultName>No_</rd:DefaultName>
                            <ActionInfo>
                              <Actions>
                                <Action>
                                  <Drillthrough>
                                    <ReportName>="/PEX/Subreports/Job Status Report_All"</ReportName>
                                    <Parameters>
                                      <Parameter Name="JobNo_">
                                        <Value>=Fields!No_.Value</Value>
                                      </Parameter>
                                    </Parameters>
                                  </Drillthrough>
                                </Action>
                              </Actions>
                            </ActionInfo>
                            <Style>
                              <Border>
                                <Color>LightGrey</Color>
                                <Style>Solid</Style>
                              </Border>
                              <BackgroundColor>Silver</BackgroundColor>
                              <PaddingLeft>2pt</PaddingLeft>
                              <PaddingRight>2pt</PaddingRight>
                              <PaddingTop>2pt</PaddingTop>
                              <PaddingBottom>2pt</PaddingBottom>
                            </Style>
                          </Textbox>
                        </CellContents>
                      </TablixHeader>
                      <TablixMembers>
                        <TablixMember />
                      </TablixMembers>
                    </TablixMember>
                  </TablixMembers>
                </TablixMember>
              </TablixMembers>
            </TablixRowHierarchy>
            <DataSetName>Profitability</DataSetName>
            <Top>1.47998cm</Top>
            <Height>1.2cm</Height>
            <Width>20.21282cm</Width>
            <ZIndex>1</ZIndex>
            <Style>
              <Border>
                <Style>None</Style>
              </Border>
            </Style>
          </Tablix>
        </ReportItems>
        <Height>33.92622mm</Height>
        <Style>
          <Border>
            <Style>None</Style>
          </Border>
        </Style>
      </Body>
      <Width>378.1058mm</Width>
      <Page>
        <PageHeight>29.7cm</PageHeight>
        <PageWidth>21cm</PageWidth>
        <LeftMargin>2cm</LeftMargin>
        <RightMargin>2cm</RightMargin>
        <TopMargin>2cm</TopMargin>
        <BottomMargin>2cm</BottomMargin>
        <ColumnSpacing>0.13cm</ColumnSpacing>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <ReportParameters>
    <ReportParameter Name="CurrentUser">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>=User!UserID</Value>
        </Values>
      </DefaultValue>
      <Prompt>CurrentUser</Prompt>
      <Hidden>true</Hidden>
    </ReportParameter>
    <ReportParameter Name="LastFriday">
      <DataType>DateTime</DataType>
      <DefaultValue>
        <Values>
          <Value>=DateAdd("d",-7,DateAdd("d",6-iif(Weekday(Today())=7,0,Weekday(Today())),Today()))</Value>
        </Values>
      </DefaultValue>
      <Hidden>true</Hidden>
    </ReportParameter>
    <ReportParameter Name="StartDate">
      <DataType>DateTime</DataType>
      <DefaultValue>
        <Values>
          <Value>06/01/2015 00:00:00</Value>
        </Values>
      </DefaultValue>
      <Prompt>StartDate</Prompt>
      <Hidden>true</Hidden>
    </ReportParameter>
    <ReportParameter Name="BusUnitGroup">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>All Teams</Value>
        </Values>
      </DefaultValue>
      <Prompt>BusUnitGroup</Prompt>
      <Hidden>true</Hidden>
    </ReportParameter>
    <ReportParameter Name="HoursTarget">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>600</Value>
        </Values>
      </DefaultValue>
      <Prompt>HoursTarget</Prompt>
      <Hidden>true</Hidden>
    </ReportParameter>
    <ReportParameter Name="MarginTarget">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>17</Value>
        </Values>
      </DefaultValue>
      <Prompt>MarginTarget</Prompt>
      <Hidden>true</Hidden>
    </ReportParameter>
  </ReportParameters>
  <Variables>
    <Variable Name="MaxDate">
      <Value>=Max(Fields!WeekEnding.Value, "AllBUTime")</Value>
    </Variable>
  </Variables>
  <rd:ReportUnitType>Cm</rd:ReportUnitType>
  <rd:ReportServerUrl>http://pmntlsql1/ReportServer</rd:ReportServerUrl>
  <rd:ReportID>9d0811f2-f5e6-43e4-9a73-0eeac6e1dbc2</rd:ReportID>
</Report>